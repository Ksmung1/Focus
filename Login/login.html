<!DOCTYPE html>
<html lang="en">

<head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>FOCUS</title>
          <link rel="stylesheet" href="login.css">


</head>

<body>
          <section>
                    <div class="login-box">
                              <form action="">
                                        <h2 class="logTitle">Login</h2>
                                        <div class="input-box hidden" id="inputBox">
                                                  <span class="icon"><ion-icon name="person-outline"></ion-icon></span>
                                                  <input type="text" id="username" required>
                                                  <label>Username</label>
                                        </div>
                                        <div class="input-box">
                                                  <span class="icon"><ion-icon name="mail"></ion-icon></span>
                                                  <input type="email" id='email' required>
                                                  <label>Email</label>
                                        </div>
                                        <div class="input-box">
                                                  <span class="icon"><ion-icon name="lock-closed"></ion-icon></span>
                                                  <input type="password" id="password" required>
                                                  <label>Password</label>
                                        </div>
                                        <div class="remember-forgot">
                                                  <label><input type="checkbox"> Remember me</label>
                                                  <a href="#">Forgot Password?</a>
                                        </div>
                                        <input type="submit" id="login" value="Login"></input>
                                        <input type="submit" class="hidden" id="register" value="SIgn up"></input>


                                        <div class="register-link">
                                                  <p class="pContent">Don't have an account?<a href="#"
                                                                      class="registerButton">Register</a></p>
                                        </div>

                              </form>
                    </div>
          </section>
          <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
          <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
          <script type='module'>


                    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.20.0/firebase-app.js";
                    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.20.0/firebase-auth.js";

                    document.addEventListener('DOMContentLoaded', () => {
                              // Your JavaScript code here


                              // For Firebase JS SDK v7.20.0 and later, measurementId is optional
                              const firebaseConfig = {
                                        apiKey: "AIzaSyABVW_aeaSCOI5xxWS3y3kffqdvgfkJJrE",
                                        authDomain: "focus-f58ac.firebaseapp.com",
                                        projectId: "focus-f58ac",
                                        storageBucket: "focus-f58ac.appspot.com",
                                        messagingSenderId: "485165420551",
                                        appId: "1:485165420551:web:28940675b55fc967e5daa2",
                                        measurementId: "G-2VV0W1FJ9Z"
                              };

                              // Initialize Firebase
                              const app = initializeApp(firebaseConfig);
                              const auth = getAuth(app);

                              const register = document.getElementById('register');
                              const login = document.getElementById('login');
                              const registerButton = document.querySelector('.registerButton');

                              console.log(login, register)
                              registerButton.addEventListener('click', () => {
                                        register.classList.toggle('hidden');
                                        login.classList.toggle('hidden');
                                        console.log('clicked');
                                        const logTitle = document.querySelector('.logTitle');
                                        if (logTitle.textContent === 'Login') {
                                                  logTitle.textContent = 'Signin';
                                        } else {
                                                  logTitle.textContent = 'Login';
                                        }
                                        // Assuming that the parent element containing the .pContent element is named .contentContainer
                                        const contentContainer = document.querySelector('.contentContainer');

                                        contentContainer.addEventListener('click', (event) => {
                                                  if (event.target.classList.contains('registerButton')) {
                                                            const pContent = document.querySelector('.pContent');
                                                            if (pContent.textContent.includes("Don't have an account?")) {
                                                                      pContent.innerHTML = `Already have an account?<a href="#" class="registerButton">Login</a>`;
                                                            } else {
                                                                      pContent.innerHTML = `Don't have an account?<a href="#" class="registerButton">Register</a>`;
                                                            }
                                                  }
                                        });



                              });


                              createUserWithEmailAndPassword(auth, email, password)
                                        .then((userCredential) => {
                                                  const user = userCredential.user;

                                                  // Update user's profile with the provided username
                                                  updateProfile(user, { displayName: username })
                                                            .then(() => {
                                                                      console.log('Username updated:', username);
                                                                      // Save username to the Firebase database
                                                                      const userRef = ref(database, 'users/' + user.uid);
                                                                      set(userRef, {
                                                                                username: username,
                                                                                email: email
                                                                      }).then(() => {
                                                                                console.log('Username saved to the database');
                                                                      }).catch((error) => {
                                                                                console.error('Error saving username to database:', error.message);
                                                                      });
                                                            })
                                                            .catch((error) => {
                                                                      console.error('Error updating username:', error.message);
                                                            });
                                        })
                                        .catch((error) => {
                                                  console.error('Registration error:', error.message);
                                        });


                    });


          </script>
          <script src="js/login.js">
                    1
          </script>
</body>

</html>