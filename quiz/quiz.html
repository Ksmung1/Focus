<!DOCTYPE html>
<html lang="en">

<head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Focus</title>
          <link rel="stylesheet" href="quiz.css">
</head>

<body>

          <div class="quiz-starter">
                    <button class="startQuiz">Start Quiz</button>
          </div>
          <div class="app hidden">
                    <h1>Quiz</h1>
                    <div class="quiz">
                              <h2 id="question"></h2>
                              <div id="answer-buttons">
                                        <button class="btn"></button>
                                        <button class="btn"></button>
                                        <button class="btn"></button>
                                        <button class="btn"></button>
                              </div>
                              <button id="next-btn">Next</button>
                    </div>
          </div>

          <script type="module">
                    const questions = [
                              {
                                        question: "What is the first letter in the alphabet?",
                                        answers: [
                                                  { text: "A", correct: true },
                                                  { text: "B", correct: false },
                                                  { text: "C", correct: false },
                                                  { text: "D", correct: false }
                                        ]
                              },
                              {
                                        question: "What is the last letter in the alphabet?",
                                        answers: [
                                                  { text: "A", correct: false },
                                                  { text: "B", correct: false },
                                                  { text: "C", correct: false },
                                                  { text: "Z", correct: true }
                                        ]
                              },
                              // Add more questions here
                    ];


                    const questionElement = document.getElementById('question');
                    const answerButtons = document.getElementById('answer-buttons');
                    const nextButton = document.getElementById('next-btn');

                    const quizapp = document.querySelector('.app');
                    const quizStarter = document.querySelector('.quiz-starter')


                    let currentQuestionIndex = 0;
                    let score = 0;

                    function startQuiz() {
                              currentQuestionIndex = 0;
                              score = 0;
                              nextButton.innerHTML = "Next";
                              showQuestion();
                    }

                    function showQuestion() {
                              resetState();
                              let currentQuestion = questions[currentQuestionIndex];
                              let questionNo = currentQuestionIndex + 1;
                              questionElement.innerHTML = questionNo + ". " + currentQuestion.question;

                              currentQuestion.answers.forEach(answer => {
                                        const button = document.createElement('button');
                                        button.innerHTML = answer.text;
                                        button.classList.add('btn');
                                        answerButtons.appendChild(button);
                                        if (answer.correct) {
                                                  button.dataset.correct = answer.correct;
                                        }
                                        button.addEventListener('click', selectAnswer);
                              });
                    }

                    function resetState() {
                              nextButton.style.display = 'none';
                              while (answerButtons.firstChild) {
                                        answerButtons.removeChild(answerButtons.firstChild);
                              }
                    }

                    function selectAnswer(e) {
                              const selectedBtn = e.target;
                              const isCorrect = selectedBtn.dataset.correct === 'true';

                              Array.from(answerButtons.children).forEach(button => {
                                        button.disabled = true; // Disable all buttons after an answer is selected
                                        if (button.dataset.correct === 'true') {
                                                  button.classList.add('correct');
                                        } else if (button !== selectedBtn) {
                                                  button.classList.add('incorrect');
                                        }
                              });

                              if (isCorrect) {
                                        selectedBtn.classList.add('correct');
                                        score++;
                              } else {
                                        selectedBtn.classList.add('incorrect');
                              }

                              nextButton.style.display = "block";
                    }


                    function showScore() {
                              resetState();
                              questionElement.innerHTML = `You scored ${score} out of ${questions.length}!`;
                              nextButton.innerHTML = 'Go Back';

                              // Create a new <p> element for nextPara
                              const nextPara = document.createElement('p');
                              console.log(score)
                              if (score > 1) {
                                        nextPara.textContent = 'Very Good!';
                              } else if (score < 1) {
                                        nextPara.textContent = 'Better luck next time.';
                              }
                              else if (score == 1) {
                                        nextPara.textContent = 'Keep it up';
                              }

                              // Append the nextPara element to the document
                              quizapp.appendChild(nextPara);

                              nextButton.style.display = 'block';
                    }


                    function handleNextButton() {
                              currentQuestionIndex++;
                              if (currentQuestionIndex < questions.length) {
                                        showQuestion();
                              } else {
                                        showScore();
                              }
                    }

                    function endQuiz() {
                              window.location.href = '../index.html?section=profile'
                    }

                    nextButton.addEventListener('click', () => {
                              if (nextButton.innerHTML === 'Go Back') {
                                        startQuiz();
                              } else {
                                        handleNextButton();
                              }
                    });
                    quizStarter.addEventListener('click', () => {
                              quizapp.classList.remove('hidden');
                              quizStarter.classList.add('hidden');
                              startQuiz();
                    })

          </script>
</body>

</html>